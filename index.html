<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FOR ABRAR & JANU üíñ</title>
<style>
body { background-color: #1a1a1a; color: #FF69B4; font-family: 'Segoe UI', sans-serif; margin: 0; overflow-x: hidden; cursor: url('https://img.icons8.com/color/32/hello-kitty.png'), auto; }

.cursor-glitter { position: fixed; width: 15px; height: 15px; background: gold; border-radius: 50%; pointer-events: none; animation: cursorGlitterFade 1.2s ease-out forwards; z-index: 9998; box-shadow: 0 0 10px gold; }
@keyframes cursorGlitterFade { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.2) translateY(30px); } }

.ambient-glitter { position: fixed; width: 12px; height: 12px; background: gold; border-radius: 50%; pointer-events: none; z-index: 1; box-shadow: 0 0 8px currentColor; animation: ambientFall linear forwards; }
@keyframes ambientFall { from { opacity: 0; transform: translateY(-20px) rotate(0deg); } 20% { opacity: 1; } 80% { opacity: 1; } to { opacity: 0; transform: translateY(100vh) rotate(360deg); } }

/* Water filling effect */
.glitter-water { position: fixed; bottom: 0; left: 0; width: 100%; height: 0%; background: linear-gradient(to top, rgba(255, 215, 0, 0.3), rgba(255, 105, 180, 0.2), rgba(0, 255, 255, 0.2)); pointer-events: none; z-index: 2; transition: height 0.3s ease-out; overflow: hidden; }
.glitter-water::before { content: ''; position: absolute; top: -50px; left: -50%; width: 200%; height: 100px; background: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.3) 0%, transparent 70%); animation: wave 3s ease-in-out infinite; }
@keyframes wave { 0%, 100% { transform: translateX(0) translateY(0); } 50% { transform: translateX(-25%) translateY(-10px); } }
.glitter-particle { position: absolute; width: 8px; height: 8px; background: gold; border-radius: 50%; animation: floatUp 4s ease-in infinite; box-shadow: 0 0 6px gold; }
@keyframes floatUp { from { transform: translateY(0) rotate(0deg); opacity: 1; } to { transform: translateY(-100px) rotate(360deg); opacity: 0; } }

#landing-page, #main-content, #sabala-sim { display: none; text-align: center; min-height: 100vh; width: 100%; position: relative; }
#landing-page { display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; overflow: hidden; z-index: 5; }
#main-content { padding: 50px 0; position: relative; overflow: hidden; z-index: 5; }

.menagerie { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin: 40px auto; max-width: 1200px; }
.animal-box { background: white; padding: 15px; border-radius: 25px; box-shadow: 8px 8px 0px #FF69B4; width: 200px; min-height: 280px; display: flex; flex-direction: column; align-items: center; justify-content: space-between; transition: 0.5s; overflow: hidden; position: relative; }
.animal-img { width: 140px; height: 140px; object-fit: contain; cursor: pointer; transition: transform 0.2s, filter 0.3s; position: relative; z-index: 1; }
.game-text { font-size: 0.8rem; color: #555; margin: 5px 0; font-weight: bold; position: relative; z-index: 10; }
button.game-btn { background: #FF69B4; color: white; border: none; padding: 10px; border-radius: 10px; cursor: pointer; font-weight: bold; position: relative; z-index: 10; }

#sabala-sim { background-color: #2ecc71; cursor: none; position: relative; overflow: hidden; }
#score-board { font-size: 30px; color: white; padding: 20px; font-weight: bold; text-shadow: 2px 2px #000; }
#sabala-container { position: absolute; bottom: 20px; transform: translateX(-50%); pointer-events: none; display: flex; flex-direction: column; align-items: center; }
#nametag { background: white; color: #FF69B4; padding: 2px 10px; border-radius: 10px; font-weight: bold; font-size: 14px; margin-bottom: 5px; box-shadow: 2px 2px 0px #000; }
#sabala-player { font-size: 60px; line-height: 1; }
.banana { position: absolute; font-size: 40px; user-select: none; z-index: 10; cursor: pointer; }

#death-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #FFD1DC; z-index: 9999; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
.ayooz-title { color: #FF1493; font-size: 5rem; margin: 0; text-shadow: 4px 4px 0px white; }
.lee-gif { width: 160px; height: 160px; margin: 10px; border-radius: 15px; border: 4px solid white; object-fit: cover; }

.glitter { position: absolute; width: 10px; height: 10px; background: gold; border-radius: 50%; pointer-events: none; animation: fall 3s linear forwards; z-index: 10000; }
@keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }

#final-boss-btn { display: inline-block; background: linear-gradient(45deg, #ffd700, #ff69b4); border: 5px solid white; padding: 20px 50px; font-size: 28px; border-radius: 50px; color: white; font-weight: bold; cursor: pointer; box-shadow: 0 0 30px gold; margin-top: 30px; animation: buttonPop 0.5s infinite alternate; }
@keyframes buttonPop { from { transform: scale(1); } to { transform: scale(1.05); } }
</style>
</head>
<body>

<div id="death-screen">
    <div id="gif-container" style="display:flex; justify-content:center;"></div>
    <h1 id="death-title" class="ayooz-title">Yal 3ayooooz</h1>
    <p style="font-size: 2rem; color: #555; font-weight: bold;">Score: <span id="final-score">0</span></p>
    <div style="display:flex; gap: 10px;">
        <button class="game-btn" id="retry-btn">RETRY üîÑ</button>
        <button class="game-btn" style="background: #555;" id="clear-btn">RESET BEST üóëÔ∏è</button>
    </div>
    <button class="game-btn" style="margin-top:20px; background: white; color: #FF69B4;" onclick="location.reload()">MAIN MENU</button>
</div>

<div id="landing-page" style="display:flex;">
    <h1>‚ö†Ô∏è CAUTION ‚ö†Ô∏è</h1>
    <p style="color:white;font-weight:bold;">DO NOT TOUCH THE PINK BUTTON.</p>
    <button id="forbidden-button" style="background-color:#FF69B4;color:white;border:4px solid white;padding:20px 40px;font-size:24px;border-radius:50px;cursor:pointer;font-weight:bold;">CLICK ME</button>
</div>

<div id="main-content">
    <h1>Happy Birthday, Abrary! üéÄ</h1>
    <div class="menagerie">
        <div class="animal-box">
            <div class="label">The f8ma</div>
            <img src="seal.png" class="animal-img" id="seal-img">
            <p id="seal-game" class="game-text">Pets: 0</p>
        </div>
        <div class="animal-box">
            <div class="label">The Fat Rabbit</div>
            <img src="bunny.png" class="animal-img" id="bun-img">
            <p id="bun-game" class="game-text">Hes always hungry...</p>
            <button class="game-btn" id="bun-btn">FEED CARROT ü•ï</button>
        </div>
        <div class="animal-box">
            <div class="label">Your Favorite Cat (lesh)</div>
            <img src="sphynx.png" class="animal-img" id="cat-img">
            <p id="cat-game" class="game-text">Temp: 20¬∞C</p>
            <button class="game-btn" id="cat-btn">TURN ON HEATER üî•</button>
        </div>
        <div class="animal-box">
            <div class="label">Janu!</div>
            <img src="janu.png" class="animal-img" id="janu-img">
            <p id="janu-game" class="game-text">Janu is watching.</p>
            <button class="game-btn" id="janu-btn">SAY HELLO</button>
        </div>
    </div>
    <button id="final-boss-btn">ENTER SABALA SIMULATOR (enti)</button>
</div>

<div id="sabala-sim">
    <div id="score-board">Bananas: 0 | High Score: <span id="high-score-val">0</span></div>
    <div id="sabala-container">
        <div id="nametag">Abrar</div>
        <div id="sabala-player">üêí</div>
    </div>
</div>

<div id="janu-scare" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2000;background:black;padding:10px;border:5px solid #FF69B4;border-radius:20px;">
    <iframe id="scare-video" width="315" height="560" src="" frameborder="0"></iframe><br>
    <button class="game-btn" onclick="closeScare()">SORRY JANU üò≠</button>
</div>

<script>
// --- BUTTON ---
const fBtn = document.getElementById("forbidden-button");
let escapes = 0;
fBtn.addEventListener("mouseover", () => {
    if(escapes<6){ 
        fBtn.style.position="absolute"; 
        fBtn.style.left=Math.random()*(window.innerWidth-200)+"px"; 
        fBtn.style.top=Math.random()*(window.innerHeight-100)+"px"; 
        escapes++; 
    }
});
fBtn.addEventListener("click", () => { 
    document.getElementById("landing-page").style.display="none"; 
    document.getElementById("main-content").style.display="block"; 
    document.body.style.backgroundColor="#FFD1DC"; 
});

// --- PETS ---
let pCount=0, bClicks=0, cTemp=20, jClicks=0;

document.getElementById("seal-img").addEventListener("click", function() {
    pCount++; 
    let msg = "Pets: " + pCount;
    
    if(pCount === 10) {
        msg = "she likes you all of a sudden..";
        alert("she likes you all of a sudden..");
    } else if(pCount === 20) {
        msg = "Shfeech mb 9a7ya? Bs laaa üòÖ";
        alert("Shfeech mb 9a7ya? Bs laaa üòÖ");
    }
    
    document.getElementById("seal-game").innerText = msg;
});

document.getElementById("bun-btn").addEventListener("click", function() {
    bClicks++;
    const bunImg = document.getElementById("bun-img");
    const bunGame = document.getElementById("bun-game");
    
    console.log("Bunny fed! Count:", bClicks); // Debug log
    
    if(bClicks < 10) {
        bunImg.style.transform=`scale(${1+bClicks*0.45})`;
        if(bClicks === 5) {
            bunGame.innerText = "Getting full... üò∞";
        } else if(bClicks === 8) {
            bunGame.innerText = "Too much... üòµ";
        }
    } else if(bClicks === 10) {
        // EXPLOSION!
        console.log("BUNNY EXPLODING!");
        bunImg.style.transition = "all 0.3s ease";
        bunImg.style.transform = "scale(0)";
        bunImg.style.opacity = "0";
        bunGame.innerText = "üí• YOU KILLED THE BUNNY! üí•";
        bunGame.style.color = "red";
        bunGame.style.fontSize = "1rem";
        bunGame.style.fontWeight = "bold";
        
        // Show guilt message
        setTimeout(() => {
            alert("üò≠ How could you?! You fed the poor bunny to death yal 7mara! üò≠\n\nThe bunny just wanted love, not ALL the carrots lesh itsaween che?!");
        }, 500);
        
        // Reset after shame
        setTimeout(() => {
            console.log("Respawning bunny...");
            bClicks = 0;
            bunImg.style.transform = "scale(1)";
            bunImg.style.opacity = "1";
            bunGame.innerText = "Hungry...";
            bunGame.style.color = "#555";
            bunGame.style.fontSize = "0.8rem";
        }, 5000);
    } else {
        // Prevent going over 10
        bClicks = 10;
    }
});

document.getElementById("cat-btn").addEventListener("click", function() {
    cTemp += 5; 
    let msg = "Temp: " + cTemp + "¬∞C";
    
    if(cTemp > 65) {
        document.getElementById("cat-img").src="sphynx_black.png";
        msg = "7aragteeee mskeeen üî•üò±";
        alert("7aragteeee mskeeen üî•üò±");
    }
    
    document.getElementById("cat-game").innerText = msg;
});

document.getElementById("janu-btn").addEventListener("click", function() {
    jClicks++; 
    if(jClicks <= 5) {
        const phrases = ["Whatcha doin?", "Abrar!", "I love Abrar!", "Muah!", "Peek-a-boo!", "Eskit!"]; 
        document.getElementById("janu-game").innerText = "Janu says: " + phrases[Math.floor(Math.random()*phrases.length)];
    } else { 
        // Start video at 6 second mark
        document.getElementById("scare-video").src = "https://www.youtube.com/embed/ix3rE46lWsU?autoplay=1&start=6"; 
        document.getElementById("janu-scare").style.display = "block"; 
    } 
});

function closeScare(){ 
    document.getElementById("scare-video").src = ""; 
    document.getElementById("janu-scare").style.display = "none"; 
    jClicks = 0; 
    document.getElementById("janu-game").innerText = "Janu is watching youuu.."; 
}

// --- SABALA GAME ---
let isSabalaActive = false;
let score = 0;
let highscore = parseInt(localStorage.getItem("sabalaHigh")) || 0;
document.getElementById("high-score-val").innerText = highscore;
let gameStartTime = 0;
let hasBeatenHighscore = false; // Track if player beat highscore this session
let allIntervals = []; // Track all active intervals
let allTimeouts = []; // Track all active timeouts

document.getElementById("final-boss-btn").addEventListener("click", function() {
    document.getElementById("main-content").style.display = "none"; 
    document.getElementById("sabala-sim").style.display = "block"; 
    startGame();
});

function startGame(){
    console.log("Starting game...");
    
    // Clean up any existing game state
    allIntervals.forEach(interval => clearInterval(interval));
    allIntervals = [];
    allTimeouts.forEach(timeout => clearTimeout(timeout));
    allTimeouts = [];
    
    // Remove any leftover bananas
    document.querySelectorAll("#sabala-sim .banana").forEach(b => b.remove());
    
    // Reset game state
    score = 0;
    hasBeatenHighscore = false;
    gameStartTime = Date.now();
    isSabalaActive = true;
    
    // Update UI safely
    const scoreBoard = document.getElementById("score-board");
    if(scoreBoard) {
        scoreBoard.innerHTML = `Bananas: 0 | High Score: ${highscore}`;
    }
    const container = document.getElementById("sabala-container");
    if(container) {
        container.style.left = "50%";
    }
    
    console.log("Game started. Active:", isSabalaActive, "HasBeaten:", hasBeatenHighscore);
    // Start spawning
    const timeout = setTimeout(() => spawnBanana(), 500);
    allTimeouts.push(timeout);
}

function spawnBanana(){
    if(!isSabalaActive) {
        console.log("Cannot spawn - game not active");
        return;
    }
    
    console.log("Spawning banana...");
    const b = document.createElement("div"); 
    b.className = "banana"; 
    b.innerHTML = "üçå";
    b.style.left = Math.random()*(window.innerWidth-50) + "px"; 
    b.style.top = "-50px";
    document.getElementById("sabala-sim").appendChild(b);

    // Progressive difficulty
    const timeElapsed = (Date.now() - gameStartTime) / 1000;
    const baseSpeed = 3.5;
    const speedIncrease = Math.min(timeElapsed * 0.18, 5);
    let fallSpeed = baseSpeed + speedIncrease;
    
    const fallInterval = setInterval(() => {
        if(!isSabalaActive){ 
            clearInterval(fallInterval);
            const idx = allIntervals.indexOf(fallInterval);
            if(idx > -1) allIntervals.splice(idx, 1);
            if(b.parentNode) b.remove(); 
            return; 
        }
        
        let topPos = parseInt(b.style.top);
        b.style.top = (topPos + fallSpeed) + "px";

        let bRect = b.getBoundingClientRect();
        let pRect = document.getElementById("sabala-player").getBoundingClientRect();

        // Collision detection - caught banana (more forgiving hitbox)
        const hitboxPadding = 10; // pixels of extra collision detection
        if(bRect.bottom > pRect.top - hitboxPadding && 
           bRect.top < pRect.bottom + hitboxPadding && 
           bRect.left < pRect.right + hitboxPadding && 
           bRect.right > pRect.left - hitboxPadding){
            console.log("CAUGHT! Score:", score + 1, "Highscore:", highscore, "HasBeaten:", hasBeatenHighscore);
            score++;
            
            // Check if just beat highscore for the first time this session
            // Note: if highscore is 0, ANY score counts as beating it
            if(!hasBeatenHighscore && score > highscore) {
                hasBeatenHighscore = true;
                // Update highscore in real-time
                const oldHighscore = highscore;
                highscore = score;
                localStorage.setItem("sabalaHigh", highscore);
                const highScoreVal = document.getElementById("high-score-val");
                if(highScoreVal) highScoreVal.innerText = highscore;
                console.log("üéâ Beat the highscore! Keep going! Old:", oldHighscore, "New:", score);
            } else if(hasBeatenHighscore && score > highscore) {
                // Continue updating highscore as player keeps going
                highscore = score;
                localStorage.setItem("sabalaHigh", highscore);
                const highScoreVal = document.getElementById("high-score-val");
                if(highScoreVal) highScoreVal.innerText = highscore;
            }
            
            const scoreBoard = document.getElementById("score-board");
            if(scoreBoard) {
                scoreBoard.innerHTML = `Bananas: ${score} | High Score: ${highscore}${hasBeatenHighscore ? ' üî•' : ''}`;
            }
            clearInterval(fallInterval);
            const idx = allIntervals.indexOf(fallInterval);
            if(idx > -1) allIntervals.splice(idx, 1);
            if(b.parentNode) b.remove();
            
            // Always spawn next banana - game continues!
            console.log("Spawning next banana after catch. Score:", score);
            const timeout = setTimeout(() => spawnBanana(), 600 + Math.random() * 400);
            allTimeouts.push(timeout);
            return;
        }

        // Missed banana - game over
        if(topPos > window.innerHeight){ 
            console.log("MISSED BANANA! Ending game. Score:", score, "HasBeaten:", hasBeatenHighscore);
            clearInterval(fallInterval);
            const idx = allIntervals.indexOf(fallInterval);
            if(idx > -1) allIntervals.splice(idx, 1);
            if(b.parentNode) b.remove();
            // Pass whether player beat highscore this session
            endGame(hasBeatenHighscore);
            return; // Important: exit the interval
        }
    }, 30);
    allIntervals.push(fallInterval);
}

function endGame(didBeatHighscore){
    if(!isSabalaActive) return; // Already ended
    
    console.log(didBeatHighscore ? "VICTORY!" : "GAME OVER", "Score:", score, "HasBeaten:", didBeatHighscore);
    isSabalaActive = false;
    
    // Clear all intervals and timeouts
    allIntervals.forEach(interval => clearInterval(interval));
    allIntervals = [];
    allTimeouts.forEach(timeout => clearTimeout(timeout));
    allTimeouts = [];
    
    // Remove all bananas
    document.querySelectorAll("#sabala-sim .banana").forEach(b => b.remove());
    
    // Highscore is already updated in real-time during play, but double-check
    if(score > highscore){
        highscore = score;
        localStorage.setItem("sabalaHigh", highscore);
        document.getElementById("high-score-val").innerText = highscore;
    }
    
    // Hide game, show result screen
    document.getElementById("sabala-sim").style.display = "none";
    document.getElementById("death-screen").style.display = "flex";
    document.getElementById("final-score").innerText = score;

    const title = document.getElementById("death-title");
    const gifBox = document.getElementById("gif-container"); 
    gifBox.innerHTML = "";

    if(didBeatHighscore) {
        // Victory screen - beat highscore during this session!
        document.getElementById("death-screen").style.background = "linear-gradient(45deg, #FFD700, #FF69B4, #00FFFF)";
        title.innerText = "üéâ 9IJ SABALA MASHALLA 3ALECH! üéâ";
        gifBox.innerHTML = '<img src="lee_dance.gif" class="lee-gif"><img src="lee_yes.gif" class="lee-gif">';
        createGlitter();
    } else {
        // Regular game over - didn't beat highscore
        document.getElementById("death-screen").style.background = "#FFD1DC";
        title.innerText = "Yal 3ayooooz";
        gifBox.innerHTML = '<img src="lee_crazy.gif" class="lee-gif">';
    }
}

function createGlitter(){
    for(let i = 0; i < 100; i++){
        setTimeout(() => {
            const glitter = document.createElement("div");
            glitter.className = "glitter";
            glitter.style.left = Math.random() * 100 + "%";
            glitter.style.top = "-10px";
            glitter.style.background = ["gold", "#FF69B4", "#00FFFF", "#FFD700", "white"][Math.floor(Math.random()*5)];
            glitter.style.animationDelay = Math.random() * 0.5 + "s";
            glitter.style.animationDuration = (Math.random() * 2 + 2) + "s";
            document.getElementById("death-screen").appendChild(glitter);
            
            setTimeout(() => glitter.remove(), 3500);
        }, i * 30);
    }
}

// Retry button
document.getElementById("retry-btn").addEventListener("click", function() {
    console.log("Retry clicked! Cleaning up and restarting...");
    
    // Clear any leftover glitter from death screen
    document.querySelectorAll("#death-screen .glitter").forEach(g => g.remove());
    
    document.getElementById("death-screen").style.display = "none";
    document.getElementById("sabala-sim").style.display = "block";
    startGame();
});

// Clear high score button
document.getElementById("clear-btn").addEventListener("click", function() {
    console.log("===== CLEARING HIGHSCORE =====");
    console.log("Before - Score:", score, "Highscore:", highscore, "Active:", isSabalaActive, "HasBeaten:", hasBeatenHighscore);
    
    // Stop current game if running
    if(isSabalaActive) {
        console.log("Stopping active game...");
        isSabalaActive = false;
        allIntervals.forEach(interval => clearInterval(interval));
        allIntervals = [];
        allTimeouts.forEach(timeout => clearTimeout(timeout));
        allTimeouts = [];
        document.querySelectorAll("#sabala-sim .banana").forEach(b => b.remove());
    }
    
    // Reset all game state
    localStorage.setItem("sabalaHigh", 0); 
    highscore = 0;
    hasBeatenHighscore = false;
    score = 0;
    
    // Update UI elements safely
    const highScoreVal = document.getElementById("high-score-val");
    if(highScoreVal) highScoreVal.innerText = 0;
    
    const scoreBoard = document.getElementById("score-board");
    if(scoreBoard) scoreBoard.innerHTML = `Bananas: 0 | High Score: 0`;
    
    console.log("After - Score:", score, "Highscore:", highscore, "Active:", isSabalaActive, "HasBeaten:", hasBeatenHighscore);
    console.log("===== HIGHSCORE CLEARED =====");
    
    alert("Record wiped! Click Retry to start fresh."); 
});

// MONKEY FOLLOW MOUSE with enhanced cursor glitter and water filling
let lastGlitterTime = 0;
let waterFillLevel = 0; // 0 to 100 percentage
let waterElement = null;
let lastWaterUpdateTime = 0;

// Create water element
function createWaterElement() {
    if(!waterElement) {
        waterElement = document.createElement("div");
        waterElement.className = "glitter-water";
        document.body.appendChild(waterElement);
        
        // Add floating glitter particles in the water
        setInterval(() => {
            if(waterFillLevel > 5) { // Only add particles when there's visible water
                const particle = document.createElement("div");
                particle.className = "glitter-particle";
                particle.style.left = Math.random() * 100 + "%";
                particle.style.bottom = Math.random() * 20 + "%";
                particle.style.background = ["gold", "#FF69B4", "#00FFFF", "#FFD700"][Math.floor(Math.random()*4)];
                particle.style.animationDelay = Math.random() * 2 + "s";
                particle.style.animationDuration = (3 + Math.random() * 2) + "s";
                waterElement.appendChild(particle);
                
                setTimeout(() => particle.remove(), 6000);
            }
        }, 500);
    }
}

// Initialize water on page load
createWaterElement();

window.addEventListener("mousemove", e => {
    const now = Date.now();
    
    // Check if we're on landing or main page (not Sabala game)
    const landing = document.getElementById("landing-page");
    const mainContent = document.getElementById("main-content");
    const sabalaActive = document.getElementById("sabala-sim").style.display !== "none";
    const isLandingVisible = landing && landing.style.display !== "none";
    const isMainVisible = mainContent && mainContent.style.display !== "none";
    const onFirstTwoPages = !sabalaActive && (isLandingVisible || isMainVisible);
    
    // Enhanced cursor glitter trail (more particles, more visible)
    if(now - lastGlitterTime > 30) {
        lastGlitterTime = now;
        
        // Create 2-3 particles instead of 1 for more intensity
        const particleCount = Math.random() > 0.5 ? 2 : 3;
        for(let i = 0; i < particleCount; i++) {
            const glitter = document.createElement("div");
            glitter.className = "cursor-glitter";
            // Add slight random offset for spread effect
            const offsetX = (Math.random() - 0.5) * 20;
            const offsetY = (Math.random() - 0.5) * 20;
            glitter.style.left = (e.pageX + offsetX) + "px";
            glitter.style.top = (e.pageY + offsetY) + "px";
            glitter.style.background = ["gold", "#FF69B4", "#00FFFF", "#FFD700", "white", "#FF1493"][Math.floor(Math.random()*6)];
            document.body.appendChild(glitter);
            
            setTimeout(() => glitter.remove(), 1200);
        }
    }
    
    // WATER FILLING: Increase water level on cursor movement (first two pages only)
    if(onFirstTwoPages && now - lastWaterUpdateTime > 50) {
        lastWaterUpdateTime = now;
        
        // Increase water level slightly with each movement
        waterFillLevel = Math.min(waterFillLevel + 0.3, 100); // Cap at 100%
        
        if(waterElement) {
            waterElement.style.height = waterFillLevel + "%";
            waterElement.style.display = "block";
        }
    }
    
    // Hide water during Sabala game
    if(sabalaActive && waterElement) {
        waterElement.style.display = "none";
    }
    
    // Sabala game-specific: move the monkey
    if(!isSabalaActive) return;
    const container = document.getElementById("sabala-container");
    let x = e.pageX; 
    if(x < 50) x = 50; 
    if(x > window.innerWidth - 50) x = window.innerWidth - 50;
    container.style.left = x + "px";
});
</script>
</body>
</html>
